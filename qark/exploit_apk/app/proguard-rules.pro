# General Android rules
-keep public class * extends android.app.Activity
-keep public class * extends android.app.Service
-keep public class * extends android.content.BroadcastReceiver
-keep public class * extends android.content.ContentProvider
-keep public class * extends android.app.Application

# Keep classes with @Keep annotation
-keep @androidx.annotation.Keep class *
-keep @androidx.annotation.Keep interface *
-keepclasseswithmembers class * {
    @androidx.annotation.Keep <methods>;
    @androidx.annotation.Keep <fields>;
}

# Keep Parcelable classes and their CREATOR fields
-keep class * implements android.os.Parcelable {
    public static final android.os.Parcelable$Creator *;
}

# Retain all native methods
-keepclasseswithmembernames class * {
    native <methods>;
}

# Keep safe serialization
-keepclassmembers class * implements java.io.Serializable {
    static final long serialVersionUID;
    private static final java.io.ObjectStreamField[] serialPersistentFields;
    private void writeObject(java.io.ObjectOutputStream);
    private void readObject(java.io.ObjectInputStream);
    private void readObjectNoData();
}

# Keep custom views to prevent UI breakage
-keep public class * extends android.view.View {
    public <init>(android.content.Context);
    public <init>(android.content.Context, android.util.AttributeSet);
    public <init>(android.content.Context, android.util.AttributeSet, int);
}

# Retain JSON Models (for Gson, Moshi, etc.)
-keep class com.yourpackage.model.** { *; }

# Keep Retrofit API models
-keep class com.yourpackage.api.** { *; }

# Keep Log statements during debug builds
-if !release
-keep class android.util.Log { *; }

# Remove Logging in Release builds
-assumenosideeffects class android.util.Log {
    public static *** v(...);
    public static *** d(...);
    public static *** i(...);
    public static *** w(...);
    public static *** e(...);
}

# Enable aggressive code shrinking
-dontshrink
-dontoptimize
-dontobfuscate

# Improve R8 optimization
-keepattributes *Annotation*

# Keep all resources
-keepresourcefiles res/values/strings.xml
-keepresourcefiles res/layout/*.xml

# Troubleshooting
-verbose
-printmapping build/outputs/mapping/mapping.txt
